import CryptoService from '../desktop/cryptoService';

beforeAll(() => {
  Object.defineProperty(global, '__generateKeyPair', {
    value: (...props) => {
      const saveKeys = props[1];

      saveKeys(
        [
          32,
          93,
          141,
          78,
          69,
          139,
          22,
          61,
          91,
          161,
          90,
          199,
          18,
          149,
          29,
          86,
          89,
          204,
          81,
          55,
          158,
          126,
          10,
          209,
          58,
          204,
          151,
          48,
          58,
          168,
          80,
          147,
        ],
        [
          102,
          157,
          9,
          17,
          149,
          249,
          80,
          230,
          37,
          90,
          46,
          135,
          120,
          238,
          167,
          190,
          79,
          122,
          102,
          175,
          232,
          85,
          149,
          116,
          4,
          236,
          21,
          32,
          200,
          161,
          31,
          241,
          32,
          93,
          141,
          78,
          69,
          139,
          22,
          61,
          91,
          161,
          90,
          199,
          18,
          149,
          29,
          86,
          89,
          204,
          81,
          55,
          158,
          126,
          10,
          209,
          58,
          204,
          151,
          48,
          58,
          168,
          80,
          147,
        ]
      );
    },
  });

  Object.defineProperty(global, '__deriveNewKeyPair', {
    value: (...props) => {
      const saveKeys = props[3];

      saveKeys(
        [
          32,
          93,
          141,
          78,
          69,
          139,
          22,
          61,
          91,
          161,
          90,
          199,
          18,
          149,
          29,
          86,
          89,
          204,
          81,
          55,
          158,
          126,
          10,
          209,
          58,
          204,
          151,
          48,
          58,
          168,
          80,
          147,
        ],
        [
          102,
          157,
          9,
          17,
          149,
          249,
          80,
          230,
          37,
          90,
          46,
          135,
          120,
          238,
          167,
          190,
          79,
          122,
          102,
          175,
          232,
          85,
          149,
          116,
          4,
          236,
          21,
          32,
          200,
          161,
          31,
          241,
          32,
          93,
          141,
          78,
          69,
          139,
          22,
          61,
          91,
          161,
          90,
          199,
          18,
          149,
          29,
          86,
          89,
          204,
          81,
          55,
          158,
          126,
          10,
          209,
          58,
          204,
          151,
          48,
          58,
          168,
          80,
          147,
        ]
      );
    },
  });
});

describe('create wallet', () => {
  const mnemonic =
    'film theme cheese broken kingdom destroy inch ready wear inspire shove pudding';
  it('match keys from mnemonic', () => {
    const result = CryptoService.createWallet(mnemonic);
    const pubKey =
      '205d8d4e458b163d5ba15ac712951d5659cc51379e7e0ad13acc97303aa85093';
    const pKey =
      '669d091195f950e6255a2e8778eea7be4f7a66afe855957404ec1520c8a11ff1205d8d4e458b163d5ba15ac712951d5659cc51379e7e0ad13acc97303aa85093';
    expect(result.address).toEqual(pubKey);
    expect(result.secretKey).toEqual(pKey);
    expect(result.publicKey).toEqual(pubKey);
  });
});
